(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{320:function(e,t,n){"use strict";var r={props:{title:{type:String,default:""},subtitle:{type:String,default:""},info:{type:String,default:""}}},o=n(11),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",{staticClass:"page-title"},[n("span",[e._v(e._s(e.title))]),e._v(" "),n("b",{directives:[{name:"show",rawName:"v-show",value:e.subtitle,expression:"subtitle"}]},[e._v("•")]),e._v(" "+e._s(e.subtitle))])}),[],!1,null,null,null);t.a=component.exports},321:function(e,t,n){"use strict";var r={props:{title:{type:String,default:null},subtitle:{type:String,default:null}}},o=n(11),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h3",{staticClass:"page-title"},[n("span",[e._v(e._s(e.title))]),e._v(" "),n("b",{directives:[{name:"show",rawName:"v-show",value:e.subtitle,expression:"subtitle"}]},[e._v("•")]),e._v(" "+e._s(e.subtitle))])}),[],!1,null,null,null);t.a=component.exports},322:function(e,t,n){},327:function(e,t,n){"use strict";var r=n(322);n.n(r).a},328:function(e,t,n){"use strict";n(40);var r=n(12),o=n(66),l=n.n(o),c={props:{name:{type:String,default:null},label:{type:String,default:null},service:{type:String,default:"images"},url:{type:String,default:null}},data:function(){return{publicUrl:null}},methods:{onFileChange:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.target.files[0]){n.next=3;break}return n.abrupt("return");case 3:if(!(r.size>5e5)){n.next=6;break}return t.$bvToast.toast("File size must not be greater than 500kb",{variant:"warning"}),n.abrupt("return");case 6:return o=r.type,t.url=URL.createObjectURL(r),n.next=10,t.getSignedUrl(o);case 10:return l=n.sent,t.publicUrl=l.public_url,t.$bvToast.toast("Uploading image. Please wait..."),n.next=15,t.uploadUrl(l.signed_url,r,o).then((function(e){t.$emit("input",t.publicUrl),t.$bvToast.toast("Image uploaded successfully",{variant:"success",solid:!0})})).catch((function(e){t.$bvToast.toast(e.message,{title:"Error",variant:"danger",solid:!0})}));case 15:n.sent;case 16:case"end":return n.stop()}}),n)})))()},getSignedUrl:function(e){var t=this,n=this.service;return this.$images.getSignedUrl(n,e).then((function(e){return e.data.data})).catch((function(e){var n=e.response;t.$bvToast.toast(JSON.stringify(n.data.errors),{title:"Error",variant:"danger",solid:!0})}))},uploadUrl:function(e,t,n){var r=this;return l.a.put(e,t,{headers:{"Content-Type":n}}).then((function(e){return e})).catch((function(e){var t=e.response;r.$bvToast.toast(JSON.stringify(t.data),{variant:"danger",solid:!0})}))}}},v=(n(327),n(11)),component=Object(v.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"mr-b-20",attrs:{id:"preview"}},[e.url?n("img",{attrs:{src:e.url}}):e._e()]),e._v(" "),n("div",{staticClass:"bg-lgray pd-10 pd-l-20 upload-btn-wrapper pd-0"},[n("button",{staticClass:"btn"},[n("i",{staticClass:"fa fa-paperclip mr-r-10"}),e._v(" "+e._s(e.label))]),e._v(" "),n("input",{attrs:{name:e.name,type:"file",accept:"image/*"},on:{change:e.onFileChange}})])])}),[],!1,null,null,null);t.a=component.exports},329:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var r=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.response)return o(t.response.data.message,n),void(t.response.data.errors&&e.each(t.response.data.errors,(function(t,i){return e.each(t,(function(e,t){return o(e,n)}))})));o(t.message,n)},o=function(e,t){console.log("------------------------------------"),console.log(e),console.log("------------------------------------"),t&&t.$bvToast.toast(e,{title:"Error",variant:"danger"})}}).call(this,n(204))},335:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(18);var r=function(text){var e=new(n(339).Converter),t=text.replace(/([ ]*\n)/g,"<br/>\n").replace(/(<br\/>\n<br\/>\n<br\/>)/g,"<br/><br/>");return e.makeHtml(t)}},336:function(e,t,n){"use strict";var r={props:{value:{type:String,default:""},editorText:{type:String,default:""}},data:function(){return{editorOptions:{useDefaultHTMLSanitizer:!1,usageStatistics:!1,hideModeSwitch:!0,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","image","link","divider","code","codeblock"]},text:this.value}},watch:{text:function(){this.$emit("input",this.text)}},methods:{onEditorChange:function(){this.$refs.toastuiEditor.invoke("getHtml"),this.$refs.toastuiEditor.invoke("getValue");var e=this.$refs.toastuiEditor.invoke("getMarkdown");this.text=e}}},o=n(11),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("client-only",[n("editor",{ref:"toastuiEditor",attrs:{"initial-value":e.editorText,options:e.editorOptions,"initial-edit-type":"wysiwyg","preview-style":"tab"},on:{change:e.onEditorChange},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}})],1)],1)}),[],!1,null,null,null);t.a=component.exports},398:function(e,t,n){},404:function(e,t,n){"use strict";n(9),n(3),n(7),n(6),n(5),n(8);var r=n(0),o=n(42),l=n(329);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var v={name:"EventRooms",props:{value:{type:String,default:""}},data:function(){return{meta:{},links:{},selectedRoom:this.value}},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(o.b)({rooms:function(e){return e.events.rooms}})),watch:{selectedRoom:function(){this.$emit("input",this.selectedRoom)}},created:function(){var e=this;this.$event.getRooms().then((function(t){var data=t.data;e.meta=data.meta,e.links=data.links,e.$store.commit("events/setRooms",data)})).catch((function(t){e.$bvToast.toast("Failed to retrieve rooms",{variant:"danger"}),Object(l.a)(t)}))},methods:{next:function(){var e=this.links.next;this.getRooms(e)},prev:function(){var e=this.links.prev;this.getRooms(e)},getRooms:function(link){var e=this;this.$resource.getAllRooms(link).then((function(t){var data=t.data;e.meta=data.meta,e.links=data.links,e.$store.commit("events/setRooms",data)})).catch((function(t){var n=t.response?"".concat(t.response.data.message," ~ ").concat(JSON.stringify(t.response.data.errors)):t.message;e.$bvToast.toast(n,{variant:"error",title:"Error"})}))}}},d=n(11),component=Object(d.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-group col-md-12"},[n("b-form-group",{attrs:{id:"rooms",label:"Rooms Available"}},e._l(e.rooms,(function(t){return n("b-form-radio",{key:t.id,attrs:{value:t.id,name:"room"},model:{value:e.selectedRoom,callback:function(t){e.selectedRoom=t},expression:"selectedRoom"}},[e._v(e._s(t.name))])})),1),e._v(" "),n("div",[n("base-pagination",{attrs:{value:e.meta.current_page,total:e.meta.total,"per-page":15,size:"sm"},on:{next:e.next,prev:e.prev}})],1)],1)}),[],!1,null,null,null);t.a=component.exports},468:function(e,t,n){"use strict";var r=n(398);n.n(r).a},542:function(e,t,n){"use strict";n.r(t);n(9),n(3),n(7),n(6),n(5),n(8),n(18),n(40);var r,o=n(12),l=n(0),c=(n(323),n(115),n(324)),v=n.n(c),d=(n(17),n(325),n(326)),m=n.n(d),f=n(116),_=n(320),h=n(321),x=n(336),y=n(328),k=n(404),O=n(335),C=(n(54),n(42)),w=n(339),$=n.n(w);function j(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function E(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?j(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):j(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var S={layout:"ShackDash",components:(r={BaseHeader:f.a,MainTitle:_.a,UploadButton:y.a,SectionTitle:h.a,HtmlEditor:x.a},Object(l.a)(r,m.a.name,m.a),Object(l.a)(r,v.a.name,v.a),Object(l.a)(r,"Room",k.a),r),asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.store,r=e.$event,o=e.params,l=e.error,c=o.id,t.next=4,r.getEventCategories().then((function(e){var data=e.data;n.commit("events/setCategories",data)})).catch((function(e){l({statusCode:e.statusCode,message:e.response?JSON.stringify(e.response.data.message):e.message})}));case 4:return t.next=6,r.getEvent(c).then((function(e){var data=e.data,t=new $.a.Converter;data.description=t.makeHtml(data.description),data.event_category_id=data.event_category.id;var n=!1;return data.room?data.room_id=data.room?data.room.id:null:n=!0,{external:n,event:data}})).catch((function(e){l({statusCode:e.statusCode,message:e.response?JSON.stringify(e.response.data.message):e.message})}));case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))()},data:function(){return{loading:!1,content:"<h1>Some initial content</h1>"}},computed:E({},Object(C.b)({categories:function(e){return e.events.categories},space:function(e){return e.space.currentSpace.subdomain}})),methods:{toggleLoading:function(){this.loading=!this.loading},startChange:function(e){this.event.end_time=this.$moment(e).add(1,"hour").format("YYYY-MM-DD HH:mm:ss")},convertTextToHtml:function(text){return Object(O.a)(text)},onEventLogoUploaded:function(e){this.event.banner_url=e},onEventBannerImageUploaded:function(e){this.event.banner_image=e},onEventHostLogoUploaded:function(e){this.event.host_logo=e},updateEvent:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!e.loading,r=e.convertTextToHtml(null!==(n=e.event.email_content)&&void 0!==n?n:""),new $.a.Converter,(o=E({},e.event)).description=o.description.replace(/(?:<br>)/g,"\n"),e.external?o.room_id=null:o.external_location=null,o.banner_url=e.event.banner_url,o.banner_image=e.event.banner_image,o.host_logo=e.event.host_logo,t.next=11,e.$event.updateEvent(e.event.id,E(E({},o),{},{email_content:r})).then((function(t){t.data;e.$bvToast.toast("Event updated successfully",{title:"Success",variant:"success",solid:!0}),e.$router.push({name:"space-events-id",params:{id:e.event.id}})})).catch((function(t){var n=t.response;e.loading=!e.loading,e.$bvToast.toast(JSON.stringify(n.data.errors),{title:"Error",variant:"danger",solid:!0})}));case 11:case"end":return t.stop()}}),t)})))()}}},T=(n(468),n(11)),component=Object(T.a)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-form",{on:{submit:function(t){return t.preventDefault(),e.updateEvent(t)}}},[n("base-header",{staticClass:"pb-6",attrs:{type:""}},[n("div",{staticClass:"d-flex justify-content-between align-items-center py-4"},[n("MainTitle",{attrs:{title:"Event",subtitle:"Update"}}),e._v(" "),n("div",[n("b-button",{staticClass:"btn btn-primary text-white",attrs:{type:"submit"}},[e.loading?n("b-spinner",{attrs:{small:"",label:"Small Spinner"}}):e._e(),e._v(" "),e.loading?e._e():n("span",[e._v("Update Event")])],1),e._v(" "),n("b-button",{staticClass:"text-danger",attrs:{variant:"transparent"},on:{click:function(t){return e.$router.go(-1)}}},[n("i",{staticClass:"fa fa-angle-left"}),e._v(" Cancel Update")])],1)],1)]),e._v(" "),n("div",{staticClass:"container-fluid mt--6"},[n("div",{staticClass:"card-deck flex-column flex-xl-row"},[n("card",[n("h3",{staticClass:"mr-b-20"},[e._v("Event Details")]),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-6"},[n("div",{staticClass:"row pd-r-20"},[n("base-input",{staticClass:"col-md-6",attrs:{id:"title",label:"Event Title",placeholder:"Awesome Co"},model:{value:e.event.name,callback:function(t){e.$set(e.event,"name",t)},expression:"event.name"}}),e._v(" "),n("base-input",{staticClass:"col-md-6",attrs:{id:"capacity",label:"Capacity",type:"number",placeholder:"0"},model:{value:e.event.total_tickets,callback:function(t){e.$set(e.event,"total_tickets",t)},expression:"event.total_tickets"}}),e._v(" "),n("div",{staticClass:"form-group col-md-12"},[n("label",[e._v("Event Description")]),e._v(" "),n("html-editor",{attrs:{id:"description","editor-text":e.event.description,placeholder:"Add details about the event"},model:{value:e.event.description,callback:function(t){e.$set(e.event,"description",t)},expression:"event.description"}})],1),e._v(" "),n("b-form-group",{staticClass:"col-md-6",attrs:{label:"Start Date"}},[n("client-only",[n("date-picker",{attrs:{id:"startTime",width:"100%","input-class":"form-control",lang:"en",format:"YYYY-MM-DD HH:mm:ss","value-type":"format",confirm:"",type:"datetime",placeholder:"Start Date"},on:{change:e.startChange},model:{value:e.event.start_time,callback:function(t){e.$set(e.event,"start_time",t)},expression:"event.start_time"}})],1)],1),e._v(" "),n("b-form-group",{staticClass:"col-md-6",attrs:{label:"End Date"}},[n("client-only",[n("date-picker",{attrs:{id:"endTime",width:"100%","input-class":"form-control",lang:"en",format:"YYYY-MM-DD HH:mm:ss","value-type":"format",confirm:"",type:"datetime",placeholder:"End Date"},model:{value:e.event.end_time,callback:function(t){e.$set(e.event,"end_time",t)},expression:"event.end_time"}})],1)],1),e._v(" "),n("base-input",{staticClass:"col-md-6",attrs:{id:"price",label:"Price",type:"number",step:"0.01",placeholder:"0.00"},model:{value:e.event.price,callback:function(t){e.$set(e.event,"price",t)},expression:"event.price"}}),e._v(" "),n("base-input",{staticClass:"col-md-6",attrs:{id:"maxTicketPerPerson",label:"Max Ticket Per Person",type:"number",placeholder:"3"},model:{value:e.event.max_ticket_per_person,callback:function(t){e.$set(e.event,"max_ticket_per_person",t)},expression:"event.max_ticket_per_person"}})],1)]),e._v(" "),n("div",{staticClass:"col-md-6"},[n("div",{staticClass:"row pd-l-20"},[n("div",{staticClass:"form-group col-md-12"},[n("label",[e._v("Event Category:")]),e._v(" "),n("el-select",{attrs:{placeholder:"Select Category"},model:{value:e.event.event_category_id,callback:function(t){e.$set(e.event,"event_category_id",t)},expression:"event.event_category_id"}},e._l(e.categories,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),n("div",{staticClass:"form-group col-md-12"},[n("b-form-checkbox",{attrs:{id:"external-1",value:!0,"unchecked-value":null,name:"external-1"},model:{value:e.external,callback:function(t){e.external=t},expression:"external"}},[e._v("\n                    Host at an external location\n                  ")]),e._v(" "),e.external?n("b-form-input",{attrs:{placeholder:"External Location",required:""},model:{value:e.event.external_location,callback:function(t){e.$set(e.event,"external_location",t)},expression:"event.external_location"}}):e._e()],1),e._v(" "),e.external?e._e():n("Room",{model:{value:e.event.room_id,callback:function(t){e.$set(e.event,"room_id",t)},expression:"event.room_id"}}),e._v(" "),n("div",{staticClass:"form-group col-md-12"},[n("b-form-checkbox",{attrs:{id:"sendEmailCheckbox",value:!0},model:{value:e.event.send_email,callback:function(t){e.$set(e.event,"send_email",t)},expression:"event.send_email"}},[e._v("Send email to attendees")])],1),e._v(" "),e.event.send_email?n("div",{staticClass:"form-group col-md-12"},[n("base-input",{attrs:{id:"emailSubject",label:"Email Subject",placeholder:"Add subject of Email"},model:{value:e.event.email_subject,callback:function(t){e.$set(e.event,"email_subject",t)},expression:"event.email_subject"}}),e._v(" "),n("b-form-group",{attrs:{label:"Email Content"}},[n("html-editor",{attrs:{id:"emailMessage",placeholder:"Message body for attendees email"},model:{value:e.event.email_content,callback:function(t){e.$set(e.event,"email_content",t)},expression:"event.email_content"}})],1)],1):e._e()],1)])]),e._v(" "),n("UploadButton",{attrs:{url:e.event.banner_url,name:"eventbanner",label:"Upload Event Image (<500KB & size 1125x582)",service:"event"},on:{input:e.onEventLogoUploaded},model:{value:e.event.event_logo,callback:function(t){e.$set(e.event,"event_logo",t)},expression:"event.event_logo"}}),e._v(" "),n("UploadButton",{attrs:{url:e.event.banner_image,name:"eventbanner",label:"Upload Event Banner (<500KB & size 1125x582)",service:"event"},model:{value:e.event.banner_image,callback:function(t){e.$set(e.event,"banner_image",t)},expression:"event.banner_image"}}),e._v(" "),n("UploadButton",{attrs:{url:e.event.host_logo,name:"hostlogo",label:"Upload Host Logo (<500KB & size 500x500)",service:"event"},model:{value:e.event.host_logo,callback:function(t){e.$set(e.event,"host_logo",t)},expression:"event.host_logo"}})],1)],1)])],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);