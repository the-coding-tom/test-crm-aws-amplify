(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{322:function(t,e,n){"use strict";var r={props:{title:{type:String,default:""},subtitle:{type:String,default:""},info:{type:String,default:""}}},l=n(11),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h1",{staticClass:"page-title"},[n("span",[t._v(t._s(t.title))]),t._v(" "),n("b",{directives:[{name:"show",rawName:"v-show",value:t.subtitle,expression:"subtitle"}]},[t._v("•")]),t._v(" "+t._s(t.subtitle))])}),[],!1,null,null,null);e.a=component.exports},323:function(t,e,n){"use strict";var r={props:{title:{type:String,default:null},subtitle:{type:String,default:null}}},l=n(11),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h3",{staticClass:"page-title"},[n("span",[t._v(t._s(t.title))]),t._v(" "),n("b",{directives:[{name:"show",rawName:"v-show",value:t.subtitle,expression:"subtitle"}]},[t._v("•")]),t._v(" "+t._s(t.subtitle))])}),[],!1,null,null,null);e.a=component.exports},338:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n(18);var r=function(text){var t=new(n(341).Converter),e=text.replace(/([ ]*\n)/g,"<br/>\n").replace(/(<br\/>\n<br\/>\n<br\/>)/g,"<br/><br/>");return t.makeHtml(e)}},339:function(t,e,n){"use strict";var r={props:{value:{type:String,default:""},editorText:{type:String,default:""}},data:function(){return{editorOptions:{useDefaultHTMLSanitizer:!1,usageStatistics:!1,hideModeSwitch:!0,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","image","link","divider","code","codeblock"]},text:this.value}},watch:{text:function(){this.$emit("input",this.text)}},methods:{onEditorChange:function(){this.$refs.toastuiEditor.invoke("getHtml"),this.$refs.toastuiEditor.invoke("getValue");var t=this.$refs.toastuiEditor.invoke("getMarkdown");this.text=t}}},l=n(11),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("client-only",[n("editor",{ref:"toastuiEditor",attrs:{"initial-value":t.editorText,options:t.editorOptions,"initial-edit-type":"wysiwyg","preview-style":"tab"},on:{change:t.onEditorChange},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1)],1)}),[],!1,null,null,null);e.a=component.exports},383:function(t,e,n){"use strict";(function(t){n(40);var r,l=n(12),o=n(1),c=(n(325),n(116),n(326)),d=n.n(c),m=(n(17),n(327),n(328)),v=n.n(m),f=n(322),h=n(323),_=n(339),w=n(338);e.a={name:"CreateMessage",layout:"ShackDash",components:(r={MainTitle:f.a,SectionTitle:h.a,HtmlEditor:_.a},Object(o.a)(r,v.a.name,v.a),Object(o.a)(r,d.a.name,d.a),r),asyncData:function(t){return Object(l.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$membership,"include=profile",e.next=4,n.getAllMemberships("include=profile").then((function(t){return{data:t.data}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))()},data:function(){return{searching:!1,emails:[],subject:"",content:"",loading:!1}},methods:{validate:function(){return 0==this.emails.length?(this.$bvToast.toast("Receipient email missing",{variant:"warning"}),!0):this.content.length<50?(this.$bvToast.toast("Email Content is required and must be more than 50 characters",{variant:"warning"}),!0):void 0},searchMembers:function(e){var link="filter[search]=".concat(e),n=this;t.debounce((function(){n.$membership.getAllMemberships(link).then((function(t){var data=t.data;n.data=data}))}),350)()},sendEmail:function(){var t=this;if(!this.validate()){this.loading=!this.loading;var e=this.emails,n=this.subject,content=this.content,body=Object(w.a)(content);this.$email.createEmail({emails:e,subject:n,content:body}).then((function(e){t.$bvToast.toast("Email sent successfully",{title:"Success",variant:"success"}),t.$router.push({name:"space-memberships-messages-id",params:{id:e.data.id}})})).catch((function(e){t.loading=!t.loading;var n=e.response?"".concat(e.response.data.message," ").concat(JSON.stringify(e.response.data.errors)):e.message;t.$bvToast(n,{title:"Error",variant:"danger"})}))}}}}}).call(this,n(206))},565:function(t,e,n){"use strict";n.r(e);var r=n(383).a,l=n(11),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-form",{on:{submit:function(e){return e.preventDefault(),t.sendEmail(e)}}},[n("base-header",{staticClass:"pb-6",attrs:{type:""}},[n("div",{staticClass:"d-flex justify-content-between align-items-center py-4"},[n("MainTitle",{attrs:{title:"Messages",subtitle:"New"}}),t._v(" "),n("b-button",{attrs:{disabled:t.loading,type:"submit",variant:"primary"}},[n("i",{staticClass:"fa fa-paper-plane"}),t._v(" Send Email")])],1)]),t._v(" "),n("div",{staticClass:"container-fluid mt--6 mr-b-30"},[n("div",{staticClass:"card-deck flex-column flex-xl-row"},[n("card",[n("div",{staticClass:"m-n25 sh-message-box"},[n("table",{staticClass:"table"},[n("tbody",[n("tr",[n("td",[n("base-input",[n("span",{staticClass:"mr-r-10"},[t._v("To")]),t._v(" "),n("el-select",{attrs:{"remote-method":t.searchMembers,loading:t.searching,required:"",multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"Add Member(s)"},model:{value:t.emails,callback:function(e){t.emails=e},expression:"emails"}},t._l(t.data,(function(option){return n("el-option",{key:option.id,attrs:{label:option.first_name+" "+option.last_name,value:option.email}})})),1)],1)],1)]),t._v(" "),n("tr",[n("td",[n("div",{staticClass:"form-inline"},[n("label",{staticClass:"mr-r-10",attrs:{for:""}},[t._v("Subject")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.subject,expression:"subject"}],staticClass:"fg-1 form-control",attrs:{id:"subject",type:"text",placeholder:"Add Subject for Email Here",required:""},domProps:{value:t.subject},on:{input:function(e){e.target.composing||(t.subject=e.target.value)}}})])])]),t._v(" "),n("tr",[n("td",[n("html-editor",{model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])])])])])],1),t._v(" "),n("b-link",{on:{click:function(e){return t.$router.go(-1)}}},[n("i",{staticClass:"fa fa-angle-left mr-r-10"}),t._v(" Back")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);