{"version":3,"file":"pages/_space/memberships/messages/create.js","sources":["webpack:///./util/convertMarkdownToHtml.js","webpack:///./components/argon-core/Inputs/HtmlEditor.vue?5ae1","webpack:///HtmlEditor.vue","webpack:///./components/argon-core/Inputs/HtmlEditor.vue?ab30","webpack:///./components/argon-core/Inputs/HtmlEditor.vue","webpack:///./pages/_space/memberships/messages/create.vue","webpack:///./pages/_space/memberships/messages/create.vue?5191","webpack:///./pages/_space/memberships/messages/create.vue?d087","webpack:///./pages/_space/memberships/messages/create.vue?8140","webpack:///./components/shack/MainTitle.vue?4b3c","webpack:///MainTitle.vue","webpack:///./components/shack/MainTitle.vue?cbd3","webpack:///./components/shack/MainTitle.vue","webpack:///./components/shack/SectionTitle.vue?33b7","webpack:///SectionTitle.vue","webpack:///./components/shack/SectionTitle.vue?3821","webpack:///./components/shack/SectionTitle.vue","webpack:///./node_modules/element-ui/lib/theme-chalk/option.css","webpack:///./node_modules/element-ui/lib/theme-chalk/select.css"],"sourcesContent":["export const convertMarkdownToHtml = text => {\n  var showdown = require('showdown')\n  var converter = new showdown.Converter()\n  const eventDescription = text.replace(/([ ]*\\n)/g, `<br/>\\n`)\n  const finalDescription = eventDescription.replace(\n    /(<br\\/>\\n<br\\/>\\n<br\\/>)/g,\n    `<br/><br/>`\n  )\n  return converter.makeHtml(finalDescription)\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('client-only',[_c('editor',{ref:\"toastuiEditor\",attrs:{\"initial-value\":_vm.editorText,\"options\":_vm.editorOptions,\"initial-edit-type\":\"wysiwyg\",\"preview-style\":\"tab\"},on:{\"change\":_vm.onEditorChange},model:{value:(_vm.text),callback:function ($$v) {_vm.text=$$v},expression:\"text\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <client-only>\n      <!-- <editor\n        v-model=\"text\"\n        :options=\"editorOptions\"\n        :initial-value=\"text\"\n        initial-edit-type=\"wysiwyg\"\n        preview-style=\"none\"\n      /> -->\n      <editor\n        ref=\"toastuiEditor\"\n        :initial-value=\"editorText\"\n        v-model=\"text\"\n        :options=\"editorOptions\"\n        initial-edit-type=\"wysiwyg\"\n        preview-style=\"tab\"\n        @change=\"onEditorChange\"\n      />\n    </client-only>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    value: {\n      type: String,\n      default: ''\n    },\n    editorText: {\n      type: String,\n      default: ''\n    }\n  },\n  data() {\n    return {\n      editorOptions: {\n        useDefaultHTMLSanitizer: false,\n        usageStatistics: false,\n        hideModeSwitch: true,\n        toolbarItems: [\n          'heading',\n          'bold',\n          'italic',\n          'strike',\n          'divider',\n          'hr',\n          'quote',\n          'divider',\n          'ul',\n          'ol',\n          'task',\n          'indent',\n          'outdent',\n          'divider',\n          //'table',\n          'image',\n          'link',\n          'divider',\n          'code',\n          'codeblock'\n        ]\n      },\n      text: this.value\n    }\n  },\n  watch: {\n    text() {\n      this.$emit('input', this.text)\n    }\n  },\n  methods: {\n    onEditorChange() {\n      let html = this.$refs.toastuiEditor.invoke('getHtml')\n      let desc = this.$refs.toastuiEditor.invoke('getValue')\n      let markdown = this.$refs.toastuiEditor.invoke('getMarkdown')\n\n      this.text = markdown\n    }\n  }\n}\n</script>\n\n<style>\n</style>\n","import mod from \"-!../../../node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HtmlEditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HtmlEditor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HtmlEditor.vue?vue&type=template&id=277b231e&\"\nimport script from \"./HtmlEditor.vue?vue&type=script&lang=js&\"\nexport * from \"./HtmlEditor.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"3c8eb076\"\n  \n)\n\nexport default component.exports","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport MainTitle from '~/components/shack/MainTitle.vue'\nimport SectionTitle from '~/components/shack/SectionTitle.vue'\nimport { Select, Option } from 'element-ui'\nimport HtmlEditor from '@/components/argon-core/Inputs/HtmlEditor'\nimport { convertMarkdownToHtml } from '@/util/convertMarkdownToHtml'\n\nexport default {\n  name: 'CreateMessage',\n  layout: 'ShackDash',\n  components: {\n    MainTitle,\n    SectionTitle,\n    HtmlEditor,\n    [Select.name]: Select,\n    [Option.name]: Option\n  },\n  async asyncData({ $membership }) {\n    const link = `include=profile`\n    return await $membership.getAllMemberships(link).then(({ data }) => {\n      return {\n        data\n      }\n    })\n  },\n  data() {\n    return {\n      searching: false,\n      emails: [],\n      subject: '',\n      content: '',\n      loading: false\n    }\n  },\n  methods: {\n    validate() {\n      if (this.emails.length == 0) {\n        this.$bvToast.toast('Receipient email missing', {\n          variant: 'warning'\n        })\n        return true\n      }\n\n      if (this.content.length < 50) {\n        this.$bvToast.toast(\n          'Email Content is required and must be more than 50 characters',\n          {\n            variant: 'warning'\n          }\n        )\n\n        return true\n      }\n    },\n    searchMembers(query) {\n      const link = `filter[search]=${query}`\n\n      const _self = this\n\n      _.debounce(() => {\n        _self.$membership.getAllMemberships(link).then(({ data }) => {\n          _self.data = data\n        })\n      }, 350)()\n    },\n    sendEmail() {\n      if (this.validate()) {\n        return\n      }\n\n      this.loading = !this.loading\n      const { emails, subject, content } = this\n\n      const body = convertMarkdownToHtml(content)\n\n      this.$email\n        .createEmail({ emails, subject, content: body })\n        .then(res => {\n          this.$bvToast.toast('Email sent successfully', {\n            title: 'Success',\n            variant: 'success'\n          })\n\n          this.$router.push({\n            name: 'space-memberships-messages-id',\n            params: { id: res.data.id }\n          })\n        })\n        .catch(e => {\n          this.loading = !this.loading\n          const message = e.response\n            ? `${e.response.data.message} ${JSON.stringify(\n                e.response.data.errors\n              )}`\n            : e.message\n          this.$bvToast(message, {\n            title: 'Error',\n            variant: 'danger'\n          })\n        })\n    }\n  }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.sendEmail($event)}}},[_c('base-header',{staticClass:\"pb-6\",attrs:{\"type\":\"\"}},[_c('div',{staticClass:\"d-flex justify-content-between align-items-center py-4\"},[_c('MainTitle',{attrs:{\"title\":\"Messages\",\"subtitle\":\"New\"}}),_vm._v(\" \"),_c('b-button',{attrs:{\"disabled\":_vm.loading,\"type\":\"submit\",\"variant\":\"primary\"}},[_c('i',{staticClass:\"fa fa-paper-plane\"}),_vm._v(\" Send Email\")])],1)]),_vm._v(\" \"),_c('div',{staticClass:\"container-fluid mt--6 mr-b-30\"},[_c('div',{staticClass:\"card-deck flex-column flex-xl-row\"},[_c('card',[_c('div',{staticClass:\"m-n25 sh-message-box\"},[_c('table',{staticClass:\"table\"},[_c('tbody',[_c('tr',[_c('td',[_c('base-input',[_c('span',{staticClass:\"mr-r-10\"},[_vm._v(\"To\")]),_vm._v(\" \"),_c('el-select',{attrs:{\"remote-method\":_vm.searchMembers,\"loading\":_vm.searching,\"required\":\"\",\"multiple\":\"\",\"filterable\":\"\",\"remote\":\"\",\"reserve-keyword\":\"\",\"placeholder\":\"Add Member(s)\"},model:{value:(_vm.emails),callback:function ($$v) {_vm.emails=$$v},expression:\"emails\"}},_vm._l((_vm.data),function(option){return _c('el-option',{key:option.id,attrs:{\"label\":option.first_name + ' ' + option.last_name,\"value\":option.email}})}),1)],1)],1)]),_vm._v(\" \"),_c('tr',[_c('td',[_c('div',{staticClass:\"form-inline\"},[_c('label',{staticClass:\"mr-r-10\",attrs:{\"for\":\"\"}},[_vm._v(\"Subject\")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.subject),expression:\"subject\"}],staticClass:\"fg-1 form-control\",attrs:{\"id\":\"subject\",\"type\":\"text\",\"placeholder\":\"Add Subject for Email Here\",\"required\":\"\"},domProps:{\"value\":(_vm.subject)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.subject=$event.target.value}}})])])]),_vm._v(\" \"),_c('tr',[_c('td',[_c('html-editor',{model:{value:(_vm.content),callback:function ($$v) {_vm.content=$$v},expression:\"content\"}})],1)])])])])])],1),_vm._v(\" \"),_c('b-link',{on:{\"click\":function($event){return _vm.$router.go(-1)}}},[_c('i',{staticClass:\"fa fa-angle-left mr-r-10\"}),_vm._v(\" Back\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js??ref--2-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./create.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js??ref--2-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./create.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./create.vue?vue&type=template&id=0a2c0fb8&\"\nimport script from \"./create.vue?vue&type=script&lang=js&\"\nexport * from \"./create.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"e94b92ee\"\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h1',{staticClass:\"page-title\"},[_vm._ssrNode(\"<span>\"+_vm._ssrEscape(_vm._s(_vm.title))+\"</span> <b\"+(_vm._ssrStyle(null,null, { display: (_vm.subtitle) ? '' : 'none' }))+\">•</b>\"+_vm._ssrEscape(\" \"+_vm._s(_vm.subtitle)))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <h1 class=\"page-title\"><span>{{ title }}</span> <b v-show=\"subtitle\">•</b> {{ subtitle }}</h1>\n</template>\n\n<script>\nexport default {\n  props: {\n    title: {\n      type: String,\n      default: ''\n    },\n    subtitle: {\n      type: String,\n      default: ''\n    },\n    info: {\n      type: String,\n      default: ''\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainTitle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainTitle.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MainTitle.vue?vue&type=template&id=eb42120a&\"\nimport script from \"./MainTitle.vue?vue&type=script&lang=js&\"\nexport * from \"./MainTitle.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"bd5e01f8\"\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h3',{staticClass:\"page-title\"},[_vm._ssrNode(\"<span>\"+_vm._ssrEscape(_vm._s(_vm.title))+\"</span> <b\"+(_vm._ssrStyle(null,null, { display: (_vm.subtitle) ? '' : 'none' }))+\">•</b>\"+_vm._ssrEscape(\" \"+_vm._s(_vm.subtitle)))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <h3 class=\"page-title\"><span>{{ title }}</span> <b v-show=\"subtitle\">•</b> {{ subtitle }}</h3>\n</template>\n\n<script>\nexport default {\n  props: {\n    title: {\n      type: String,\n      default: null\n    },\n    subtitle: {\n      type: String,\n      default: null\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SectionTitle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SectionTitle.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SectionTitle.vue?vue&type=template&id=b54cd52a&\"\nimport script from \"./SectionTitle.vue?vue&type=script&lang=js&\"\nexport * from \"./SectionTitle.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"1090309e\"\n  \n)\n\nexport default component.exports","// Exports\nmodule.exports = {};\n","// Exports\nmodule.exports = {};\n"],"mappings":";;;;;;;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAIA;AACA;;;;;;;;;;ACTA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACsBA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AALA;AACA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AAgBA;AApBA;AA2BA;AA5BA;AA8BA;AACA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAKA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AARA;AAhDA;;ACxBA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAMA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AAGA;AADA;AAKA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAFA;AAKA;AACA;AACA;AAAA;AAAA;AAFA;AAIA;AAEA;AACA;AAKA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAnEA;AA3BA;;;;;;;;;;;;;ACvFA;AACA;AACA;;;;;;;;ACFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AClBA;AACA;AACA;;;;;;;;;ACGA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AATA;AADA;;ACLA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AClBA;AACA;AACA;;;;;;;;;ACGA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AALA;AADA;;ACLA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AClBA;AACA;;;;;;;;ACDA;AACA;;;;;A","sourceRoot":""}